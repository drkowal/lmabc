---
title: "lmabc-vignette1"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{lmabc-vignette1}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---
The aim of this vignette is to demonstrate when and how to use lmabc, and how to interpret results compared to normal lm.  
```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```
First, load necessary libraries/packages:
```{r setup}
library(lmabc)
library(MASS)
require(DataExplorer)
```


```{r}
#library(tidyverse)
#install.packages("DataExplorer")
#library(DataExplorer)
#install.packages("mice")
#library(mice)
#install.packages("Hmisc")
#library("Hmisc")

```

For this vignette, lets use the publicly available birthwt dataset.   
The birthwt dataset from the MASS package has data on 189 births at the Baystate Medical Centre, Springfield, Massachusetts during 1986 (Venables & Ripley, 2002). 
The dataframe contains these columns (taken directly from documentation):  

|Field|Description|
|---:|:---|
|low|indicator of birth weight less than 2.5kg|
|age|mother’s age in years|
|lwt|mother’s weight in pounds at last menstrual period|
|race|mother’s race (1 = white, 2 = black, 3 = other)|
|smoke|smoking status during pregnancy|
|ptl|number of previous premature labors|
|ht|history of hypertension|
|ui|presence of uterine irritability|
|ftv|number of physician visits during the first trimester|
|bwt|birth weight in grams|

First, look at dataset to understand its format and characteristics.
```{r}
head(birthwt)
```

Variables like ptl are zero inflated.  
Most are categorical (race, smoke, ptl, ht, ui, ftv, low).  
Only age, lwt, and bwt are continuous 

First, lets reformat our variables.   
1. Change race from numbers to the correct category label.  
2. Make smoke, ptl, ht, and ui T/F.  



```{r}
birthweight3 <- with(birthwt, {
	race <- factor(race, labels = c("white", "black", "other"))
	data.frame(age, lwt, race, smoke = factor(smoke > 0), ptl = factor(ptl > 0), ht = factor(ht > 0), ui = factor(ui > 0 ), ftv, bwt)
})

head(birthweight3)
```

Now that we have our data formatted, lets investigate relationships between them.  

Let's say we want to explore if the variation birthweight (bwt) can be explained by .... (variables we want)..   Do we want to build up the model slowly and show different interpretations/interations or just go for it? 




Plot normal lm model for dataset
```{r}
lm_ft <- lm(bwt~., birthweight3)
lm_ft
summary(lm_ft)
```

Low R^2 score, but...
"Some fields of study have an inherently greater amount of unexplainable variation. In these areas, your R^2 values are bound to be lower. For example, studies that try to explain human behavior generally have R^2 values less than 50%. People are just harder to predict than things like physical processes."

```{r}
#null hypothesis for lm, no linear relationship between x val and the response 
lmabc_bwt <- lmabc::lm_abc(bwt~., birthweight3)
lmabc_bwt
summary(lmabc_bwt)
```

DO WE NEED TO CENTER CONTINUOUS COVARIATES?? IF SO, ADD 



FROM OLD FIRST DRAFT OF VIGNETTE 

```{r}
birthweight <- with(birthwt, {
	race <- factor(race, labels = c("white", "black", "other"))
	ptd <- factor(ptl > 0)
	ftv <- factor(ftv)
	levels(ftv)[-(1:2)] <- "2+"
	data.frame(age, lwt, race, smoke = (smoke > 0), ptd, ht = (ht > 0), ui = (ui > 0), ftv, bwt)
})
```

```{r}
birthweight2 <- with(birthwt, {
	race <- factor(race, labels = c("white", "black", "other"))
	ptd <- factor(ptl > 0)
	ftv <- factor(ftv)
	data.frame(age, lwt, race, smoke = factor(smoke > 0), ptd, ht = factor(ht > 0), ui = factor(ui > 0), ftv, bwt)
})
#ftv is a factor here

```

```{r}
birthweight3 <- with(birthwt, {
	race <- factor(race, labels = c("white", "black", "other"))
	ptd <- factor(ptl > 0)
	data.frame(age, lwt, race, smoke = factor(smoke), ptd, ht = factor(ht > 0), ui = factor(ui > 0 ), ftv, bwt)
})
#ftv continuous
birthweight3
```

```{r}
lm_ft <- lm(bwt~., birthweight3)
lm_ft
summary(lm_ft)
```

Low R^2 score, but...
"Some fields of study have an inherently greater amount of unexplainable variation. In these areas, your R^2 values are bound to be lower. For example, studies that try to explain human behavior generally have R^2 values less than 50%. People are just harder to predict than things like physical processes."
```{r}
#null hypothesis for lm, no linear relationship between x val and the response 
lmabc_bwt <- lmabc::lm_abc(bwt~., birthweight3)
lmabc_bwt
summary(lmabc_bwt)
```
ASSUMPTIONS:
linearity 
homoscesticity - the varance around the line of prediction is about the same for all values of x 
independence
normality 

```{r}
plot(lm_ft)
```

```{r}
plot(lmabc_bwt)
```
Check if residuals are normally distributed
Q-Q

The relationship between the sample percentiles and theoretical percentiles is  linear. The condition that the error terms are normally distributed is met to use lm. 
