<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="lmabc is used to fit linear models using abundance-based constraints (ABCs).
For regression models with categorical covariates, ABCs
provide 1) more equitable output, 2) better statistical efficiency,
and 3) more interpretable parameters, especially in the
presence of interaction (or modifier) effects."><title>Fitting Linear Models with Abundance-Based Constraints (ABCs) — lmabc • lmabc</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fitting Linear Models with Abundance-Based Constraints (ABCs) — lmabc"><meta property="og:description" content="lmabc is used to fit linear models using abundance-based constraints (ABCs).
For regression models with categorical covariates, ABCs
provide 1) more equitable output, 2) better statistical efficiency,
and 3) more interpretable parameters, especially in the
presence of interaction (or modifier) effects."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">lmabc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/introduction.html">Interpretation of Linear Regression Models with Abundance-Based Constraints</a>
    <a class="dropdown-item" href="../articles/limitations.html">Limitations of lmabc</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/prayaggordy/lmabc/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Fitting Linear Models with Abundance-Based Constraints (ABCs)</h1>
      <small class="dont-index">Source: <a href="https://github.com/prayaggordy/lmabc/blob/HEAD/R/lmabc.R" class="external-link"><code>R/lmabc.R</code></a></small>
      <div class="d-none name"><code>lmabc.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>lmabc</code> is used to fit linear models using abundance-based constraints (ABCs).
For regression models with categorical covariates, ABCs
provide 1) more equitable output, 2) better statistical efficiency,
and 3) more interpretable parameters, especially in the
presence of interaction (or modifier) effects.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">lmabc</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, <span class="va">...</span>, cprobs <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>formula</dt>
<dd><p>an object of class "<code><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula()</a></code>" (or one that can be coerced to that class); a symbolic description of the model to be fitted.</p></dd>


<dt>data</dt>
<dd><p>a data frame (or object coercible by <code>as.data.frame</code> to a data frame) containing the variables in the model.</p></dd>


<dt>...</dt>
<dd><p>For <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>: additional arguments to be passed to the low level
    regression fitting functions (see below).</p></dd>


<dt>cprobs</dt>
<dd><p>an optional named list with an entry for each named categorical variable in the model, specifying the probabilities of each category, which must sum to 1. By default, <code>cprobs</code> will be calculated from the proportions in the data.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>An <code>lmabc</code> model is specified identically to the corresponding <code>lm</code> model.
At this time, <code>lmabc</code> only supports a single response variable, and the data must be passed into the <code>data</code> parameter.</p>
    </div>
    <div class="section level2">
    <h2 id="differences-from-lm">Differences from <code>lm</code><a class="anchor" aria-label="anchor" href="#differences-from-lm"></a></h2>
    <p>The default approach for linear regression with categorical covariates
is reference group encoding (RGE): one category is selected as the "reference group"
for each categorical variable, and all results are presented
relative to this group. However, this approach produces output that is
inequitable (and potentially misleading), estimators that are statistically inefficient,
and model parameters that are difficult to interpret.</p>
<p>For example, suppose an analyst fits a model of the form <code>y ~ x + race + x:race</code>,
where <code>x</code> is a continuous covariate. This model allows for <code>race</code>-specific
coefficients on <code>x</code> (or slopes). However, RGE requires a reference group;
for <code>race</code>, this is typically non-Hispanic White (NHW). This creates several problems:</p><ol><li><p>All output is presented relative to the reference (NHW) group:
the results for <code>(Intercept)</code> and <code>x</code> refer to the intercept and slope, respectively,
<em>for the reference (NHW) group</em>. This can lead to misleading conclusions
about the overall <code>x</code> effect, since the dependence on the reference
group is not made clear. All other <code>race</code> and <code>x:race</code> effects
are presented relative to the reference (NHW) group, which
elevates this group above all others.</p></li>
<li><p>Compared to the main-only model <code>y ~ x + race</code>, adding the
<code>x:race</code> interaction alters the estimates and standard errors of
the <code>x</code> effect. This typically results in a loss of statistical power:
the <code>x</code> effect now refers to a subset of the data (the reference group).</p></li>
<li><p>Since all categorical covariates and interactions are
anchored at a reference group, it becomes increasingly
difficult to interpret the model parameters in the
presence of multiple categorical variables (<code>race</code>, <code>sex</code>, etc.)
and interactions.</p></li>
</ol><p><code>lmabc</code> addresses these issues. ABCs parametrize the regression model so that the main effect terms, here
<code>(Intercept)</code> and <code>x</code>, are <em>averages</em> of the race-specific terms.
The notion of "average" derives from the argument <code>cprob</code>: these can be
input by the user (e.g., population proportions), otherwise
they will be set to the sample proportions for each group. ABCs provide
several key advantages:</p><ol><li><p><strong>Equitability</strong>: the main <code>x</code> effect is
parameterized as "group-averaged" effect. It does not
elevate any single group (e.g., NHW). All other group-specific effects
are relative to this global term, rather than any
single group.</p></li>
<li><p><strong>Efficiency</strong>: comparing the main-only model <code>y ~ x + race</code>
with the race-modified model <code>y ~ x + race + x:race</code>, ABCs
(with the default <code>cprobs</code>) ensure that the main <code>x</code> effect estimates
are (nearly) unchanged and the standard errors are (nearly) unchanged
or smaller. Remarkably, there are no negative (statistical) consequences for
including the interaction <code>x:race</code>, even if it is irrelevant.</p></li>
<li><p><strong>Interpretability</strong>: The <code>x</code> and <code>x:race</code> coefficients are
"group-averaged" <code>x</code>-effects and "group-specific deviations", respectively.
Coupled with the ABCs estimation/inference invariance, this
yields simple interpretations of main and interaction effects.</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="similarities-to-lm">Similarities to <code>lm</code><a class="anchor" aria-label="anchor" href="#similarities-to-lm"></a></h2>
    <p><code>lmabc</code> is a reparametrization of the linear model,
but the fitted values, predictions, and residuals will be the same
as <code>lm</code> (see <code><a href="cv.penlmabc.html">cv.penlmabc()</a></code> for an example where this is no longer the case).
Without categorical covariates, <code>lmabc</code> output will be
identical to <code>lm</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>lmabc</code> returns an object of class "lmabc." Many generics commonly used for <code>lm</code> objects have been implemented for <code>lmabc</code>: <code>summary</code>, <code>coefficients</code>, <code>plot</code>, <code>predict</code>, and more. See the DESCRIPTION file for all implemented S3 methods.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> for the standard linear regression implementation in R.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">lmabc</span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Petal.Length</span> <span class="op">+</span> <span class="va">Species</span> <span class="op">+</span> <span class="va">Petal.Length</span><span class="op">*</span><span class="va">Species</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lmabc(formula = Sepal.Length ~ Petal.Length + Species + Petal.Length * </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Species, data = iris)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Min       1Q   Median       3Q      Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.73479 -0.22785 -0.03132  0.24375  0.93608 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                 Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)                     5.524317   0.220516  25.052  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Petal.Length                    0.788771   0.102549   7.692 2.09e-12 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Speciessetosa                   0.726787   0.428933   1.694  0.09235 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Speciesversicolor              -0.004114   0.224189  -0.018  0.98538    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Speciesvirginica               -0.722672   0.239830  -3.013  0.00305 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Petal.Length:Speciessetosa     -0.246478   0.189867  -1.298  0.19631    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Petal.Length:Speciesversicolor  0.039510   0.118337   0.334  0.73896    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Petal.Length:Speciesvirginica   0.206968   0.114212   1.812  0.07205 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 0.3365 on 144 degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple R-squared:  0.8405,	Adjusted R-squared:  0.8349 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-statistic: 151.7 on 5 and 144 DF,  p-value: &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span>, newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Petal.Length <span class="op">=</span> <span class="fl">1.5</span>, Species <span class="op">=</span> <span class="st">"setosa"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.026607 </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Dan Kowal, Prayag Gordy, Virginia Baskin, Jai Uparkar.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

