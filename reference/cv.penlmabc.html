<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="cv.penlmabc fits penalized (lasso or ridge) linear models
using abundance-based constraints (ABCs). For penalized regression
with categorical covariates, ABCs eliminate harmful biases
(e.g., with respect to race, sex, religion, etc.), provide
more meaningful notions of sparsity, and improve interpretability."><title>Fitting Lasso/Ridge Regression with Abundance-Based Constraints (ABCs) — cv.penlmabc • lmabc</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fitting Lasso/Ridge Regression with Abundance-Based Constraints (ABCs) — cv.penlmabc"><meta property="og:description" content="cv.penlmabc fits penalized (lasso or ridge) linear models
using abundance-based constraints (ABCs). For penalized regression
with categorical covariates, ABCs eliminate harmful biases
(e.g., with respect to race, sex, religion, etc.), provide
more meaningful notions of sparsity, and improve interpretability."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">lmabc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/introduction.html">The 'ABCs' of `lmabc`: linear regression with categorical covariates</a>
    <a class="dropdown-item" href="../articles/limitations.html">Limitations of lmabc</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/prayaggordy/lmabc/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Fitting Lasso/Ridge Regression with Abundance-Based Constraints (ABCs)</h1>
      <small class="dont-index">Source: <a href="https://github.com/prayaggordy/lmabc/blob/HEAD/R/cv.penlmabc.R" class="external-link"><code>R/cv.penlmabc.R</code></a></small>
      <div class="d-none name"><code>cv.penlmabc.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>cv.penlmabc</code> fits penalized (lasso or ridge) linear models
using abundance-based constraints (ABCs). For penalized regression
with categorical covariates, ABCs eliminate harmful biases
(e.g., with respect to race, sex, religion, etc.), provide
more meaningful notions of sparsity, and improve interpretability.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cv.penlmabc</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"lasso"</span>,</span>
<span>  lambda_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  K <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  props <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>formula</dt>
<dd><p>an object of class "<code><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula()</a></code>" (or one that can be coerced to that class); a symbolic description of the model to be fitted.</p></dd>


<dt>data</dt>
<dd><p>a data frame (or object coercible by <code>as.data.frame</code> to a data frame) containing the variables in the model.</p></dd>


<dt>type</dt>
<dd><p>either "lasso" or "ridge"</p></dd>


<dt>lambda_path</dt>
<dd><p>optional vector of tuning parameters;
defaults are inherited from <code>glmnet</code> (for ridge) or <code>genlasso</code> (for lasso)</p></dd>


<dt>K</dt>
<dd><p>number of folds for cross-validation; default is 10</p></dd>


<dt>props</dt>
<dd><p>an optional named list with an entry for each named categorical variable in the model, specifying the proportions of each category. By default, <code>props</code> will be calculated from the empirical proportions in the data.</p></dd>


<dt>plot</dt>
<dd><p>logical; if TRUE, include a plot of the cross-validated
MSE across <code>lambda_path</code> values</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>cv.penlmabc</code> solves the penalized least squares problem</p>
<p>\(|| y - X\beta||^2 + \lambda \sum_j |\beta_j|^\gamma\)</p>
<p>for lasso (\(\gamma=1\)) or ridge (\(\gamma=2\)) regression,
and specifically using ABCs for categorical covariates and interactions.</p>
<p>Default strategies for categorical covariates typically
use reference group encoding (RGE), which removes
the coefficient for one group for each
categorical variable (and their interactions).
However, because lasso and ridge shrink coefficients
toward zero, this implies that all other coefficients are
<em>biased</em> toward their reference group. Such bias is
clearly problematic for variables such as race, sex, and other
protected groups, but also it attenuates the estimated differences
among groups, which can obscure important group-specific
effects (e.g., for <code>x:race</code>). The penalized estimates and predictions
under RGE are dependent on the choice of the reference group.</p>
<p>Alternatively, it is possible to fit penalized least squares
with an overparametrized model, i.e., without deleting a
reference group (or applying any types of constraints). However,
the parameters are not identifiable and thus not interpretable
in general. With lasso estimation, this approach empirically tends
to select a reference group, and therefore suffers
from the same significant problems as RGE.</p>
<p>Instead, ABCs provide a parametrization of the main
effects as "group-averaged" effects, with interaction terms
(e.g., <code>x:race</code>) as "group-specific deviations".
These estimators are not biased toward any single group
and the predictive performance does not depend on the
choice of a reference group. ABCs provide appealing estimation
invariance properties for models with or without interactions
(e.g., <code>x:race</code>), and therefore offer a natural parametrization
for sparse (e.g., lasso) estimation with categorical covariates
and their interactions.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>cv.penlmabc</code> returns a list with the following elements:</p><ul><li><p><code>coefficients</code> estimated coefficients at each tuning
parameter in <code>lambda_path</code></p></li>
<li><p><code>lambda_path</code> vector of tuning parameters</p></li>
<li><p><code>df</code> degrees of freedom at each tuning
parameter in <code>lambda_path</code></p></li>
<li><p><code>mse</code> cross-validated mean squared error (MSE) at each tuning
parameter in <code>lambda_path</code></p></li>
<li><p><code>se</code> standard error of the CV-MSE at each tuning
parameter in <code>lambda_path</code></p></li>
<li><p><code>ind.min</code> index of the minimum CV-MSE in <code>lambda_path</code></p></li>
<li><p><code>ind.1se</code> index of the one-standard error rule in <code>lambda_path</code></p></li>
<li><p><code>lambda.min</code> tuning parameter that achieves the minimum CV-MSE</p></li>
<li><p><code>lambda.1se</code> tuning parameter that achieves the one-standard error rule</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example lasso fit:</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">cv.penlmabc</span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Petal.Length</span> <span class="op">+</span> <span class="va">Species</span> <span class="op">+</span> <span class="va">Petal.Length</span><span class="op">*</span><span class="va">Species</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "coefficients" "lambda_path"  "df"           "mse"          "se"          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6] "ind.min"      "ind.1se"      "lambda.min"   "lambda.1se"  </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Estimated coefficients at the one-standard error rule:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">[</span>,<span class="va">fit</span><span class="op">$</span><span class="va">ind.1se</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    (Intercept)                   Petal.Length </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      5.4684391                      0.5527580 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  Speciessetosa              Speciesversicolor </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      0.0000000                      0.0000000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Speciesvirginica     Petal.Length:Speciessetosa </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      0.0000000                     -0.3454960 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Petal.Length:Speciesversicolor  Petal.Length:Speciesvirginica </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      0.2737565                      0.0717395 </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Dan Kowal, Prayag Gordy, Virginia Baskin, Jai Uparkar.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

